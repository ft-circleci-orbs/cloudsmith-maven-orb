description:
  Generate temporary Cloudsmith credentials using OIDC and construct a maven registry URL string for a specific Cloudsmith
  repository. On completion the command sets the CLOUDSMITH_MAVEN_REGISTRY environment variable for
  use with maven. The registry url includes Cloudsmith authentication credentials generated using OIDC.
parameters:
  repository:
    description: The identity/slug of the Cloudsmith repository
    type: string
steps:
  - run:
      name: Cloudsmith - Set environment variables
      command: cloudsmith-maven/set_env_vars_for_maven
      

description: >
  Generate temporary Cloudsmith credentials using OIDC and construct a maven registry URL string for a specific Cloudsmith
  repository. On completion the command sets the CLOUDSMITH_MAVEN_REGISTRY environment variable for
  use with maven. The registry url includes Cloudsmith authentication credentials generated using OIDC.

usage:
  version: 2.1
  orbs:
    cloudsmith-maven: ft-circleci-orbs/cloudsmith-maven@1.0
  jobs:
    build:
      docker:
        - image: cimg/openjdk:21.0.2
      steps:
        - checkout
        - cloudsmith-maven/set_env_vars_for_maven:
            repository: "your-repository-id"
        - run:
          name: Set environment 
          command: mvn install
          working_directory: ~/project/.circleci/simple-maven-package-test/maven-package-test
  workflows:
    main:
      jobs:
        - build
